# ⚙️ STM32 기반 공 카운터 & 서보모터 제어 시스템

## 📌 프로젝트 개요
본 프로젝트는 **STM32 마이크로컨트롤러**를 활용하여  
- **ADC 센서 입력**  
- **PWM 기반 서보모터 제어**  
- **7-Segment 디스플레이 출력**  

등 다양한 기능을 **레지스터 레벨(Low-level)**로 직접 구현한 시스템입니다.  
공이 여러 개의 홀(구멍)에 떨어지는 상황을 센싱하고, 서보모터로 제어하며,  
실시간으로 개수를 카운트하여 디스플레이에 표시합니다.

---

## 🛠️ 주요 특징

- **레지스터 기반 하드웨어 제어**
  - STM32 **데이터시트 및 레퍼런스 매뉴얼**을 기반으로  
    RCC, GPIO, ADC, TIM, PWM, BSRR 레지스터를 직접 설정
  - HAL/LL 라이브러리를 사용하지 않고 **Low-level 접근**으로 구현

- **ADC 센서 입력**
  - `ADC1_IN0`, `ADC1_IN2`, `ADC1_IN3` 채널에서 **아날로그 값 샘플링**
  - 센서 값을 실시간으로 읽어 서보모터 제어에 활용

- **PWM 기반 서보모터 제어**
  - `TIM3_CH1`, `TIM3_CH2` 채널을 활용해 PWM 신호 생성
  - 듀티사이클을 조절하여 모터 각도를 제어하고, 공의 흐름을 유도

- **7-Segment 디스플레이 출력**
  - 7447 IC를 활용해 **각 홀에 빠진 공의 개수**를 세그먼트로 출력
  - 레지스터 `BSRR`를 직접 제어하여 세그먼트 핀을 On/Off

- **실시간 동작**
  - `Mydelay()` 등 간단한 소프트웨어 딜레이로 반응속도 조절
  - 공의 흐름을 **실시간으로 감지하고 즉각적으로 동작**

---

## 🧩 시스템 구조

1. **센서 감지 (ADC)**
   - 공이 특정 구간을 지날 때 센서가 값을 감지
   - ADC 값을 읽어 일정 기준 이하일 때 이벤트 발생

2. **모터 제어 (PWM)**
   - 감지된 값에 따라 서보모터 각도를 변경
   - 특정 타이밍에 구슬이 특정 홀로 빠지도록 유도

3. **카운팅 및 표시 (7-Segment)**
   - 각 홀에 빠진 공의 개수를 카운트
   - 해당 개수를 7-Segment에 출력

---

## 🎮 실행 흐름
1. 전원이 켜지면 `hwInit()`으로 기본 하드웨어 초기화  
2. `GPIO_ADC_SETTING()` → 센서 입력 설정  
3. `PWM_SETTING()` → TIM3 기반 PWM 신호 설정  
4. 메인 루프에서
   - ADC로 센서 값 읽기
   - 값에 따라 PWM 제어 (서보모터 동작)
   - 공의 개수 카운트 및 Segment 출력

---

## 📷 결과
- 공이 각 홀에 빠지는 과정이 **실시간으로 감지 및 제어**
- **센서 입력 → 모터 제어 → 카운트 표시**가 매끄럽게 연결
- 데이터시트 기반 저수준 접근으로 MCU 하드웨어 동작 원리를 직접 확인 가능

---

## 🚀 프로젝트 의의
- **레지스터 직접 접근을 통한 임베디드 시스템 이해**
- **ADC, PWM, GPIO, 7-Segment** 등 핵심 MCU 기능을 전부 실습
- 추후 더 큰 임베디드 프로젝트에서 안정적인 기반 코드로 활용 가능
- HAL이나 Arduino 라이브러리 의존도가 없기 때문에  
  **하드웨어 제어 원리와 구조를 깊이 이해**할 수 있었음

---
